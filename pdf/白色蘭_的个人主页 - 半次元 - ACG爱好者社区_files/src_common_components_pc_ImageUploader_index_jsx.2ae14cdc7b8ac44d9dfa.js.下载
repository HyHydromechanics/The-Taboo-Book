(self.webpackChunkfe_banciyuan_web=self.webpackChunkfe_banciyuan_web||[]).push([["src_common_components_pc_ImageUploader_index_jsx"],{"./src/common/components/pc/ImageUploader/PreviewImage.jsx":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(r("./node_modules/react/index.js")),o=r("./node_modules/byted-dimension-ui/lib/index.js");var a=(0,r("./node_modules/react-sortable-hoc/dist/react-sortable-hoc.esm.js").SortableElement)(function(e){var t=e.url,r=e.path,a=e.deleteImage,i=e.mIndex;return n.default.createElement("div",{className:"wrapper"},n.default.createElement("div",{className:"image-upload-pic",style:{backgroundImage:"url(".concat(t,")")}}),n.default.createElement(o.Icon,{className:"preview-item__close white",type:"close",onClick:function(e){e.stopPropagation(),a(r,i)}}))});t.default=a},"./src/common/components/pc/ImageUploader/index.jsx":function(e,t,r){"use strict";function n(e){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var r=b(t);if(r&&r.has(e))return r.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=a?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(o,i,l):o[i]=e[i]}o.default=e,r&&r.set(e,o);return o}(r("./node_modules/react/index.js")),i=r("./src/common/utils/index.js"),l=r("./node_modules/byted-dimension-ui/lib/index.js"),c=y(r("./node_modules/autobind-decorator/lib/esm/index.js")),u=y(r("./node_modules/lodash.get/index.js")),s=r("./node_modules/react-sortable-hoc/dist/react-sortable-hoc.esm.js"),p=y(r("./node_modules/array-move/index.js")),f=y(r("./src/common/services/ItemSvc.js")),d=y(r("./src/common/components/pc/ImageUploader/PreviewImage.jsx")),m=y(r("./src/common/asset/images/collection/load.png"));function y(e){return e&&e.__esModule?e:{default:e}}function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(b=function(e){return e?r:t})(e)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){h(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,o=I(e);if(t){var a=I(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t,r,n,o){var a={};return Object.keys(n).forEach(function(e){a[e]=n[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}r("./src/common/components/pc/ImageUploader/style.css");var S=(0,s.SortableContainer)(function(e){var t=e.items,r=e.deleteImage;return a.default.createElement("div",{className:"image-preview-wrapper"},t.map(function(e,t){var n=e.path,o=e.url,i=e.mid;return a.default.createElement(d.default,{key:n||i,index:t,mIndex:t,value:n,path:n,url:o,deleteImage:r,className:"image-upload-pic"})}))}),x=(D((o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(r,a.Component);var t=A(r);function r(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this,e)).state={images:e.initImages||[],progress:0},n}return function(e,t,r){t&&E(e.prototype,t),r&&E(e,r)}(r,[{key:"onSortEnd",value:function(e){var t=this,r=e.oldIndex,n=e.newIndex;n!==r&&this.setState(function(e){var t=e.images;return{images:(0,p.default)(t,r,n)}},function(){t.props.updateMulti(t.state.images)})}},{key:"handleUpload",value:function(e){var t=this;if(e)if(e.size>20971520)l.message.error("对不起，请上传小于20MB的图片");else{var r={token_type:"bcy_vip",options:{bucket:"bcy_vip",token_type:"bcy_vip",noMeta:!0},file:e},n=(0,i.tosUpload)(r);n.on("process",function(e){t.setState({progress:e.percent})}),n.on("error",function(){l.message.error("上传失败请重新尝试")}),n.on("complete",function(r){r.oid?t.showThumbnail(r,e):l.message.error("上传失败请重新尝试")})}}},{key:"uploadImg",value:function(){var e=this.inputFile.files;if(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=O(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(l)throw a}}}}(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.handleUpload(n)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"handleDeleteImage",value:function(e,t){var r=this,n=this.state.images[t];if(n&&n.path===e){var o=this.state.images;this.setState({images:[].concat(w(o.slice(0,t)),w(o.slice(t+1)))},function(){r.props.updateMulti(r.state.images)})}}},{key:"showThumbnail",value:function(e,t){var r=this,n=new FileReader,o={path:e.oid,mid:0,mtype:"add",format:""};n.readAsDataURL(t),n.onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){var e=v(v({},o),{},{w:t.width,h:t.height});f.default.postUploadImg({multi:e}).then(function(t){0===t.code?e.url=t.data.url:l.message.error(t.msg);var n=[].concat(w(r.state.images),[e]);r.setState({images:n}),r.props.updateMulti(n)})}}}},{key:"shouldCancelStart",value:function(e){return!!Array.from((0,u.default)(e,"target.classList",[])).includes("preview-item__close")}},{key:"render",value:function(){var e=this,t=this.state,r=t.images,n=t.progress;return a.default.createElement("div",{className:"uploader-wrapper"},a.default.createElement(S,{items:r,onSortEnd:this.onSortEnd,axis:"xy",lockAxis:"xy",lockToContainerEdges:!0,shouldCancelStart:this.shouldCancelStart,deleteImage:this.handleDeleteImage,getContainer:function(){return document.getElementsByClassName("uploader-wrapper")[0]},helperClass:"image-upload-pic"}),0!==n&&100!==n&&a.default.createElement("div",{className:"upload-progress"},"".concat(n,"%"),a.default.createElement("div",{className:"barBox"},a.default.createElement("div",{id:"uploadingBarImg",className:"bar",style:{width:"".concat(n,"%")}}))),a.default.createElement("div",{className:"create-collection-upload"},a.default.createElement("input",{type:"file",multiple:!0,className:"create-collection-add-img",accept:"image/jpeg,image/png,image/gif",onChange:this.uploadImg,ref:function(t){e.inputFile=t}}),a.default.createElement("img",{src:m.default,style:{width:"30px",height:"30px",top:"32px"},className:"collection-upload-img"}),a.default.createElement("p",{className:"upload-text"},"点击添加图片",a.default.createElement("br",null),"不超过20M")))}}]),r}()).prototype,"onSortEnd",[c.default],Object.getOwnPropertyDescriptor(o.prototype,"onSortEnd"),o.prototype),D(o.prototype,"handleUpload",[c.default],Object.getOwnPropertyDescriptor(o.prototype,"handleUpload"),o.prototype),D(o.prototype,"uploadImg",[c.default],Object.getOwnPropertyDescriptor(o.prototype,"uploadImg"),o.prototype),D(o.prototype,"handleDeleteImage",[c.default],Object.getOwnPropertyDescriptor(o.prototype,"handleDeleteImage"),o.prototype),D(o.prototype,"showThumbnail",[c.default],Object.getOwnPropertyDescriptor(o.prototype,"showThumbnail"),o.prototype),o);t.default=x},"./src/common/components/pc/ImageUploader/style.css":function(e,t,r){"use strict";r.r(t)},"./src/common/asset/images/collection/load.png":function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAABSNJREFUaAXlm01s3EQUx+fN2rsFhDhRykelcqo4c4iQKkputGlSEYlDucAFeiISdMOtHNob2QBKT+FEL90DUhCkaTkhQJWqHHpGOVEJEBWcqoiPtb37eP/ZzMre3di1104cZ6TEY3vmvffzm/F8+C2pghLPrj4eqL9PKe6+zEQnidVJZnWMiJ8UlfhD2mambSL1gEltEfOWoto9Rz1xh9Yv/tMvku9/ylMcv7F01Pf0W0S9eZE7JYD1LPLlAXhSb5NZr7n13g36evHPLHLG1ckF2J9rvap6alExv85KOeMUZb0mBgaK6Dul1ZL7bfOnrHJsvYmA/bnladXjK8x8ygos8khEd5Tiy+7NxR+y6skEzPOfPet3usui/EJWxZPVo7bbqF2itQ/+SCsnNXAw2zrDPW5L030qrbI8y4vhD0nTBWe9eTuNXJ2msD/TuiTN9+Z+w8Jm2ABbYFMahkfyML+/0vDve6vSX99OI3zPymq67p6oX6RrC50knYnA/ObK08G/nW9kiHklSdh+3peh7K7zWOM8fbXwV5wdsU0anj0IsACEQ4ytYnNmYDTjsns2DAdbTdcLXxzK7+ph8zIoa58dgoicis1xL7KxfdgMPXgbs8xvDmCS/tyTScq5cUPWCDAmFUEn+LkMQ88kz1rAHjoN56XhycmIBzGDKhJWnvxtt9E47taOPC+euDUJVFxdMPRng9FSEQ9jbszd3vfRIvmeAZbWFn6DVJ5fecHvdH7NV0NUmjzU6fDcO+phWQhEi+d/ZmEhOZzPX5OVSFdtDscBsD/76em9WvWEDSg6DyawWT0DYMW9pr1YuWOIzQBjpwKL98qBWiBsTIBRkgHGtoy81XLdqbC6ynAEGxgHwDt7UGWwrTAbLKPG7qJomSpMU3kET4FVYytVppCZdhfLw5JsCRjBqrFvnFy8IiWEVWOTvCI4iRhg1fgikFiyIgXAqqVtH6sITyIGWB1865FM6oRVj1OvvzfpfLi+sRhZwCQZggVH4HlfyJTxTFLZ4ftgxcTDftgavh97ngdsrIJdbuIBQ/cut5MuG+CkQpW6Dw9vZyEKvM4qz117LkvdSerYJp1RxjZ5M61fZCl+IqOA1NWG+6w3s5ThDZJa7U4Fuq9lR+BB1uoHrR5YZeKhtg6a4VntBatMPCTM4JAksGrEVBwSXtlEq93TJoCkH1NRaW7pvx5Y9U60zGalaftwm2Dt72lJtEzVgRERBEYDbEKDEC1T0SST9QCMA2ATB4XQoKomYbOxXsbDhlPioKrKK+14wDYARtBXPw6qWthgCge0DYD7XqaPi8bF5N/q4PPLx22+uCNfDsseWXzLYkI6d3EBZzIe3nL0kXeVwzrrQj4MEJ+ndn2jaTbgbbmRrw2IcJMP4mdlCVNI4Jnsrpz1u//9rrrWhGKO4kn5IF4bieGKNmnRjS/miHATT/SKMaV4qbDdMIwJTRwBhjkmNoLpo+JNK0iD2D4uvgPaRvpw2ARvtvVlaaPvwoaG8xKVV19vvhO+FM6P9bAtYML5JMLNnpf9KE35LmyOszPWw6h4qEIPAYzYRefFxrSSpoLzUiaxDTYmxVnC9kQPhwFNhBvxJzK0xHaFcJ0i82YkkReUu9GUYPVHS6mAIfJQBYgDGK97RLhJ42jjfH8StWHDbkNPnE2pPRwW5p9bek3Ar+5VuFN/cbMPP/IIQyNv4qAQGlTkz3hIt9z1D38c1p32fCIPDyvjuc+f8btdmZZW/Idaw+A4L+tP8f4HGOgL1Pb2Q5wAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=src_common_components_pc_ImageUploader_index_jsx.2ae14cdc7b8ac44d9dfa.js.map