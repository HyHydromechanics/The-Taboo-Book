!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).TTGCaptcha={})}(this,(function(t){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return o(null==e&&n.path)}},n.exports),n.exports}function o(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var i=r((function(t,e){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
t.exports=function(){function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,s=void 0,u=function(t,e){w[o]=t,w[o+1]=e,2===(o+=2)&&(s?s(b):S())};function c(t){s=t}function a(t){u=t}var f="undefined"!=typeof window?window:void 0,l=f||{},d=l.MutationObserver||l.WebKitMutationObserver,p="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){return function(){return process.nextTick(b)}}function _(){return void 0!==i?function(){i(b)}:m()}function y(){var t=0,e=new d(b),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function g(){var t=new MessageChannel;return t.port1.onmessage=b,function(){return t.port2.postMessage(0)}}function m(){var t=setTimeout;return function(){return t(b,1)}}var w=new Array(1e3);function b(){for(var t=0;t<o;t+=2)(0,w[t])(w[t+1]),w[t]=void 0,w[t+1]=void 0;o=0}function O(){try{var t=Function("return this")().require("vertx");return i=t.runOnLoop||t.runOnContext,_()}catch(t){return m()}}var S=void 0;function k(t,e){var n=this,r=new this.constructor(j);void 0===r[T]&&G(r);var o=n._state;if(o){var i=arguments[o-1];u((function(){return K(o,r,i,n._result)}))}else I(n,r,t,e);return r}function E(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(j);return M(n,t),n}S=p?h():d?y():v?g():void 0===f?O():m();var T=Math.random().toString(36).substring(2);function j(){}var C=void 0,x=1,A=2;function D(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function N(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function q(t,e,n){u((function(t){var r=!1,o=N(n,e,(function(n){r||(r=!0,e!==n?M(t,n):R(t,n))}),(function(e){r||(r=!0,U(t,e))}),"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,U(t,o))}),t)}function H(t,e){e._state===x?R(t,e._result):e._state===A?U(t,e._result):I(e,void 0,(function(e){return M(t,e)}),(function(e){return U(t,e)}))}function J(t,n,r){n.constructor===t.constructor&&r===k&&n.constructor.resolve===E?H(t,n):void 0===r?R(t,n):e(r)?q(t,n,r):R(t,n)}function M(e,n){if(e===n)U(e,D());else if(t(n)){var r=void 0;try{r=n.then}catch(t){return void U(e,t)}J(e,n,r)}else R(e,n)}function F(t){t._onerror&&t._onerror(t._result),B(t)}function R(t,e){t._state===C&&(t._result=e,t._state=x,0!==t._subscribers.length&&u(B,t))}function U(t,e){t._state===C&&(t._state=A,t._result=e,u(F,t))}function I(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+x]=n,o[i+A]=r,0===i&&t._state&&u(B,t)}function B(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?K(n,r,o,i):o(i);t._subscribers.length=0}}function K(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=!0;if(i){try{s=r(o)}catch(t){c=!1,u=t}if(n===s)return void U(n,P())}else s=o;n._state!==C||(i&&c?M(n,s):!1===c?U(n,u):t===x?R(n,s):t===A&&U(n,s))}function L(t,e){try{e((function(e){M(t,e)}),(function(e){U(t,e)}))}catch(e){U(t,e)}}var Y=0;function z(){return Y++}function G(t){t[T]=Y++,t._state=void 0,t._result=void 0,t._subscribers=[]}function V(){return new Error("Array Methods must be provided an Array")}var X=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(j),this.promise[T]||G(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&R(this.promise,this._result))):U(this.promise,V())}return t.prototype._enumerate=function(t){for(var e=0;this._state===C&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===E){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(t){s=!0,i=t}if(o===k&&t._state!==C)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===et){var u=new n(j);s?U(u,i):J(u,t,o),this._willSettleAt(u,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===C&&(this._remaining--,t===A?U(r,n):this._result[e]=n),0===this._remaining&&R(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;I(t,void 0,(function(t){return n._settledAt(x,e,t)}),(function(t){return n._settledAt(A,e,t)}))},t}();function W(t){return new X(this,t).promise}function Z(t){var e=this;return r(t)?new e((function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))}function Q(t){var e=new this(j);return U(e,t),e}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var et=function(){function t(e){this[T]=z(),this._result=this._state=void 0,this._subscribers=[],j!==e&&("function"!=typeof e&&$(),this instanceof t?L(this,e):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var n=this,r=n.constructor;return e(t)?n.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):n.then(t,t)},t}();function nt(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=et}return et.prototype.then=k,et.all=W,et.race=Z,et.resolve=E,et.reject=Q,et._setScheduler=c,et._setAsap=a,et._asap=u,et.polyfill=nt,et.Promise=et,et}()})),s="s_v_web_id",u="/vc/setting",c="/captcha/reportFrontend",a=function(t){var e=t.url,n=t.method,r=t.data,o=t.config;return new i((function(t,i){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===s.DONE)if(s.status>=200&&s.status<300){var e={},n=s.response||s.responseText,r=s.getResponseHeader("Content-Type");if(r&&-1!==r.indexOf("application/json"))try{e=JSON.parse(n)}catch(t){}else e=n;setTimeout((function(){t(e)}),0)}else i(new TypeError("Network request failed"))},s.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){i(new DOMException("Aborted","AbortError"))}),0)};var u=e;if((null==o?void 0:o.params)&&(u=u+"?"+function(t){for(var e=Object.keys(t),n="",r=0;r<e.length;r++){var o=e[r],i=t[o],s=encodeURIComponent(o)+"="+encodeURIComponent(i);n=r>=1?n+"&"+s:s}return n}(o.params)),s.open(n,u,!0),s.timeout=5e3,null==o?void 0:o.headers)for(var c=o.headers,a=0,f=Object.keys(c);a<f.length;a++){var l=f[a];s.setRequestHeader(l,c[l])}(null==o?void 0:o.withCredentials)&&(s.withCredentials=o.withCredentials),"POST"===n.toUpperCase()&&r?s.send(JSON.stringify(r)):s.send(null)}))},f=function(t,e){return void 0===e&&(e={}),a({url:t,method:"GET",config:e})},l=function(t,n,r){void 0===r&&(r={});var o=r.headers?e({"Content-Type":"application/json"},r.headers):{"Content-Type":"application/json"};return a({url:t,method:"POST",data:n,config:e(e({},r),{headers:o})})},d=function(t){return new i((function(e,n){var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("src",t),r.appendChild(o);var i=setTimeout((function(){n(new Error("LoadJSSDKMoreTan4000ms"))}),4e3);o.onload=function(){clearTimeout(i),e(0)},o.onerror=function(){clearTimeout(i),n(new Error("Failed to load SDK!"))}}))},p={serverHost:"",settingHost:""},v=function(){var t=p.settingHost;return l(""+t+u,{},{headers:{"X-Setting-Flag":1}})},h=new(function(){function t(){this.conf={app_id:0,user_unique_id:"",evtParams:{}}}return t.prototype.init=function(t,n){void 0===n&&(n={}),this.conf.app_id="cn"===t.region?2018:2740,this.conf.user_unique_id=t.user_unique_id||"",this.conf.evtParams=e(e({},n),{webdriver:"undefined",isScheduling:"false",product_host:window.location.host,product_path:window.location.hostname,type:2,aid:t.aid,did:t.did,iid:t.iid})},t.prototype.setParams=function(t){this.conf.evtParams=e(e({},this.conf.evtParams),t)},t.prototype.trackEvent=function(t,n){void 0===n&&(n={});var r=[{events:[{event:"turing_verify_sdk",is_bav:0,local_time_ms:Date.now(),params:JSON.stringify(e(e(e({},this.conf.evtParams),n),{key:"h5_"+t,time:Date.now()}))}],header:{app_id:this.conf.app_id},user:{user_unique_id:this.conf.user_unique_id}}];this.sendEvents(r)},t.prototype.sendEvents=function(t){var e,n;(e={logs:t},n=p.serverHost,l(""+n+c,e)).catch((function(t){console.log("report err: ",t)}))},t}()),_=r((function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function i(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c].split(";")[0]));return document.cookie=e+"="+n+u}}function s(t,n){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var u=i[s].split("="),c=u.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var a=e(u[0]);if(c=(r.read||r)(c,a)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(o[a]=c,t===a)break}catch(t){}}return t?o[t]:o}}return o.set=i,o.get=function(t){return s(t,!1)},o.getJSON=function(t){return s(t,!0)},o.remove=function(e,n){i(e,"",t(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}((function(){}))},t.exports=n()}));function y(t){t="object"==typeof t?t:{};var e=Date.now(),n=function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=t.length,n=Date.now().toString(36),r=[];r[8]=r[13]=r[18]=r[23]="_",r[14]="4";for(var o=0,i=void 0;o<36;o++)r[o]||(i=0|Math.random()*e,r[o]=t[19==o?3&i|8:i]);return"verify_"+n+"_"+r.join("")}(),r={path:"/"};t.domain&&/^([a-z0-9-]+)?(\.[a-z0-9-]+)+$/.test(t.domain)&&(r.domain=t.domain),_.set(s,n,r);var o=!!n&&!!_.get(s);return h.trackEvent("fp_set_cookie",{duration:Date.now()-e,is_success:o?1:0,msg:o?"":n?"set cookie failed":"generate fp failed"}),n}var g=function(t){void 0===t&&(t={});var e=function(t){void 0===t&&(t={});var e=_.get(s);return e&&0===e.indexOf("verify_")||(e=y(t)),e}(t);return i.resolve(e)},m=!1,w={},b={},O=null,S=function(t,e){var n=Date.now();i.resolve({});return("script"===e?d(t).catch((function(e){return d(t)})).then((function(){return O=window.verifySDK})):f(t).catch((function(e){return f(t)})).then((function(t){var e=function(t){var e={exports:{}};return new Function("exports","module",t)(e.exports,e),e}(t);return O=e.exports}))).then((function(t){return h.trackEvent("hotsdk_loadscript",{is_success:1,duration:Date.now()-n,message:""}),t})).catch((function(t){return h.trackEvent("hotsdk_loadscript",{is_success:0,duration:Date.now()-n,message:t.message}),i.reject(t)}))},k=function(){var t;(null===(t=null==b?void 0:b.captchaOptions)||void 0===t?void 0:t.challenge_code)?null==O||O.renderCaptcha(e(e({},w),b)):null==O||O.autoRender(b)},E=function(t,n,r,o){var s;if(void 0===r&&(r=function(){}),void 0===o&&(o=function(){}),w=e(e({},t),{captchaOptions:e(e({},null==t?void 0:t.captchaOptions),{h5_check_version:"3.3.5"})}),O)return JSON.stringify(t)!==JSON.stringify({})&&(null==O||O.initVerifyOptions(w)),void r(O);!function(t){p.serverHost=t.serverHost,p.settingHost=t.settingHost}(n);var u=(null===(s=null==w?void 0:w.captchaOptions)||void 0===s?void 0:s.executor)||n.executor,c=function(t,e){var n=t.commonOptions,r=t.captchaOptions;return{aid:(null==n?void 0:n.aid)||t.aid,did:(null==n?void 0:n.did)||t.did,iid:(null==n?void 0:n.iid)||t.iid,user_unique_id:null==r?void 0:r.user_unique_id,region:e.region}}(w,n);h.init(c),h.trackEvent("hotsdk_init"),function(t){var e=t.region,n=Date.now();return v().catch((function(){return v()})).then((function(t){var r;return h.trackEvent("hotsdk_getsetting",{is_success:1,duration:Date.now()-n,message:""}),null===(r=null==t?void 0:t.verify)||void 0===r?void 0:r.js[e]})).catch((function(t){return h.trackEvent("hotsdk_getsetting",{is_success:0,duration:Date.now()-n,message:null==t?void 0:t.message}),i.reject(t)}))}(n).catch((function(t){var e;return o({type:"loadSettings",msg:null!==(e=null==t?void 0:t.message)&&void 0!==e?e:""}),n.cdn})).then((function(e){S(e,u).then((function(e){JSON.stringify(t)!==JSON.stringify({})&&(null==e||e.initVerifyOptions(w)),m&&(m=!1,k()),r(e)})).catch((function(t){var e;o({type:"loadJSSDK",msg:null!==(e=null==t?void 0:t.message)&&void 0!==e?e:""})}))}))},T={region:"cn",executor:"Function",serverHost:"https://verify.snssdk.com",settingHost:"https://vcs.snssdk.com",cdn:"https://lf-cdn-tos.bytescm.com/obj/static/secsdk-captcha/cn2/2.20.5/captcha.js"};t.close=function(){null==O||O.closeCaptcha()},t.getFp=function(){var t;return g(null===(t=null==w?void 0:w.captchaOptions)||void 0===t?void 0:t.fpCookieOption)},t.init=function(t,n,r){E(e({},t),T,n,r)},t.render=function(t){h.trackEvent("hotsdk_render"),b=t,O?k():m=!0},Object.defineProperty(t,"__esModule",{value:!0})}));